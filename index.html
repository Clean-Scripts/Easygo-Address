<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Easy Go | Address</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <!-- Your existing HTML structure -->
    
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCU_wJYBTwEwMZQ-iTYOjUZuEHEphA0DXc",
            authDomain: "easygo-10f4b.firebaseapp.com",
            projectId: "easygo-10f4b",
            storageBucket: "easygo-10f4b.firebasestorage.app",
            messagingSenderId: "197660067542",
            appId: "1:197660067542:web:6c616efb479b122f1f6b77",
            databaseURL: "https://easygo-10f4b-default-rtdb.asia-southeast1.firebasedatabase.app/"
        };
        
        let database;
        let isFirebaseConnected = false;
        
        function initializeFirebase() {
            try {
                const app = firebase.initializeApp(firebaseConfig);
                database = firebase.database();
                
                const connectedRef = database.ref(".info/connected");
                connectedRef.on("value", function(snap) {
                    isFirebaseConnected = snap.val() === true;
                });
            } catch (error) {
                console.error("Firebase error:", error);
            }
        }
        
        // Save address to Firebase
        async function saveAddressToFirebase(addressData) {
            if (!isFirebaseConnected) return null;
            
            try {
                const addressRef = database.ref('addresses').push();
                await addressRef.set({
                    ...addressData,
                    timestamp: Date.now(),
                    date: new Date().toLocaleString('en-IN', { timeZone: 'Asia/Kolkata' })
                });
                
                return addressRef.key;
            } catch (error) {
                console.error("Error saving address:", error);
                return null;
            }
        }
        
        // Save delivery charges
        async function saveDeliveryCharges(chargesData) {
            if (!isFirebaseConnected) return false;
            
            try {
                await database.ref('delivery_charges').push().set({
                    ...chargesData,
                    timestamp: Date.now(),
                    date: new Date().toLocaleString('en-IN', { timeZone: 'Asia/Kolkata' })
                });
                return true;
            } catch (error) {
                console.error("Error saving delivery charges:", error);
                return false;
            }
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeFirebase();
            
            // Update your existing saveAddress function
            function saveAddress() {
                // Your existing address saving logic
                const addressData = {
                    // Collect address data from form
                };
                
                // Save to Firebase
                saveAddressToFirebase(addressData);
                
                // Continue with existing logic
            }
            
            // Update delivery charges calculation
            function updateDeliveryCharges() {
                // Your existing calculation logic
                const chargesData = {
                    // Delivery charges data
                };
                
                // Save to Firebase
                saveDeliveryCharges(chargesData);
                
                // Continue with existing logic
            }
        });
    </script>
</body>
</html>

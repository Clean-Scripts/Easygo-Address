<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EasyGo | Address & Delivery</title>
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="https://raw.githubusercontent.com/Clean-Scripts/EasyGo-Address/refs/heads/main/logo.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        /* Banner Background */
        .banner-bg {
            background-image: url('https://raw.githubusercontent.com/Clean-Scripts/EasyGo-Address/refs/heads/main/Banner.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            min-height: 100vh;
        }
        
        /* Overlay for better readability */
        .content-overlay {
            background: rgba(0, 0, 0, 0.7);
            min-height: 100vh;
        }
        
        /* Card styles */
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        /* Map container */
        .map-container {
            height: 300px;
            width: 100%;
            border-radius: 1rem;
            overflow: hidden;
        }
        
        /* Floating labels */
        .floating-label-group {
            position: relative;
            margin-bottom: 1.5rem;
        }
        
        .floating-label {
            position: absolute;
            top: -0.75rem;
            left: 0.75rem;
            font-size: 0.75rem;
            color: #3b82f6;
            background: white;
            padding: 0 0.5rem;
            z-index: 10;
            transition: all 0.2s ease;
            opacity: 0;
        }
        
        .floating-input:focus ~ .floating-label,
        .floating-input:not(:placeholder-shown) ~ .floating-label {
            opacity: 1;
        }
        
        /* Step indicators */
        .step-indicator {
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 0.5rem;
        }
        
        .step-completed {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        
        .step-active {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }
        
        .step-inactive {
            background-color: #e5e7eb;
            color: #6b7280;
        }
        
        /* Progress bar */
        .progress-bar {
            height: 0.375rem;
            border-radius: 0.25rem;
            background: #e5e7eb;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #3b82f6);
            transition: width 0.5s ease;
        }
        
        /* Button animations */
        .btn-pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(59, 130, 246, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);
            }
        }
        
        /* Shake animation for errors */
        .shake {
            animation: shake 0.5s;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        /* Empty cart overlay */
        #emptyCartOverlay {
            transition: all 0.3s ease;
        }
        
        /* Loader animation */
        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Custom marker for user location */
        .custom-marker {
            background: transparent !important;
            border: none !important;
        }
    </style>
</head>
<body class="banner-bg">
    
    <!-- Empty Cart Overlay -->
    <div id="emptyCartOverlay" class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-10 rounded-2xl shadow-2xl text-center max-w-md mx-4">
            <div class="text-6xl mb-6">ðŸ›’</div>
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Your Cart is Empty</h2>
            <p class="text-gray-600 mb-6">You need to add items to your cart before proceeding to address details.</p>
            <p class="text-sm text-gray-500 mb-8">Redirecting to menu in <span id="countdown">5</span> seconds...</p>
            <a href="https://clean-scripts.github.io/Easygo-Menu/" 
               class="inline-flex items-center gap-3 px-8 py-4 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-bold rounded-xl hover:opacity-90 transition">
                <i class="fas fa-shopping-cart"></i>
                Go to Menu Now
            </a>
        </div>
    </div>
    
    <!-- Content Overlay -->
    <div class="content-overlay">
        <div class="max-w-7xl mx-auto px-4 py-8">
            <!-- Header with Logo -->
            <header class="mb-8">
                <div class="flex flex-col md:flex-row items-center justify-between gap-6 mb-8">
                    <!-- Logo -->
                    <div class="flex items-center gap-4">
                        <div class="w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-xl">
                            <img src="https://raw.githubusercontent.com/Clean-Scripts/EasyGo-Address/refs/heads/main/logo.png" 
                                 alt="EasyGo Logo" 
                                 class="w-14 h-14 object-contain">
                        </div>
                        <div>
                            <h1 class="text-3xl md:text-4xl font-bold text-white">EasyGo Address</h1>
                            <p class="text-white/80">Enter your details for delivery</p>
                        </div>
                    </div>
                    
                    <!-- Cart Summary -->
                    <div id="cart-summary-badge" class="bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl px-6 py-3">
                        <div class="flex items-center gap-3">
                            <i class="fas fa-shopping-cart text-white text-xl"></i>
                            <div>
                                <p class="text-white/80 text-sm">Cart Total</p>
                                <p id="cart-total-badge" class="font-bold text-white text-xl">â‚¹0</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Progress Steps -->
                <div class="glass-card rounded-2xl p-6 mb-8">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center">
                            <div class="step-indicator step-completed">
                                <i class="fas fa-check text-sm"></i>
                            </div>
                            <div>
                                <p class="font-semibold text-gray-700">Step 1</p>
                                <p class="text-green-600 text-sm">Cart</p>
                            </div>
                        </div>
                        
                        <div class="flex-1 mx-4">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 50%"></div>
                            </div>
                        </div>
                        
                        <div class="flex items-center">
                            <div class="step-indicator step-active">
                                2
                            </div>
                            <div>
                                <p class="font-semibold text-gray-700">Step 2</p>
                                <p class="text-blue-600 text-sm">Address & Delivery</p>
                            </div>
                        </div>
                        
                        <div class="flex-1 mx-4">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="flex items-center">
                            <div class="step-indicator step-inactive">
                                3
                            </div>
                            <div>
                                <p class="font-semibold text-gray-700">Step 3</p>
                                <p class="text-gray-500 text-sm">Payment</p>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Main Content -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Left Column -->
                <div class="space-y-8">
                    <!-- Delivery Mode Selection -->
                    <div class="glass-card rounded-2xl p-8">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">Select Delivery Mode</h2>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Delivery Option -->
                            <div id="delivery-option" 
                                 class="border-2 border-blue-500 bg-blue-50 rounded-xl p-6 cursor-pointer transition-all duration-300 hover:shadow-lg"
                                 onclick="switchToDelivery()">
                                <div class="flex items-center gap-4">
                                    <div class="w-14 h-14 bg-blue-500 rounded-full flex items-center justify-center">
                                        <i class="fas fa-motorcycle text-white text-xl"></i>
                                    </div>
                                    <div>
                                        <h3 class="font-bold text-gray-800 text-lg">Home Delivery</h3>
                                        <p class="text-blue-600 text-sm mt-1">Delivered to your doorstep</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Takeaway Option -->
                            <div id="takeaway-option" 
                                 class="border-2 border-gray-300 rounded-xl p-6 cursor-pointer transition-all duration-300 hover:border-green-500 hover:shadow-lg"
                                 onclick="switchToTakeaway()">
                                <div class="flex items-center gap-4">
                                    <div class="w-14 h-14 bg-gray-300 rounded-full flex items-center justify-center">
                                        <i class="fas fa-store text-gray-600 text-xl"></i>
                                    </div>
                                    <div>
                                        <h3 class="font-bold text-gray-800 text-lg">Takeaway</h3>
                                        <p class="text-gray-600 text-sm mt-1">Pickup from Prime Square</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Delivery Address Form (Hidden for Takeaway) -->
                    <div id="address-form-section" class="glass-card rounded-2xl p-8">
                        <div class="flex items-center gap-3 mb-6">
                            <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center">
                                <i class="fas fa-map-marker-alt text-blue-600 text-xl"></i>
                            </div>
                            <h2 class="text-2xl font-bold text-gray-800">Delivery Address</h2>
                        </div>
                        
                        <form id="addressForm" class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Name -->
                                <div class="md:col-span-2">
                                    <div class="floating-label-group">
                                        <input type="text" 
                                               id="name" 
                                               required
                                               class="floating-input w-full p-4 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition"
                                               placeholder="Full Name">
                                        <label class="floating-label">Full Name *</label>
                                    </div>
                                </div>
                                
                                <!-- Phone Number -->
                                <div class="md:col-span-2">
                                    <div class="floating-label-group">
                                        <input type="tel" 
                                               id="phone" 
                                               required
                                               pattern="[0-9]{10}"
                                               class="floating-input w-full p-4 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition"
                                               placeholder="Phone Number">
                                        <label class="floating-label">Phone Number *</label>
                                    </div>
                                </div>
                                
                                <!-- Address Type -->
                                <div>
                                    <div class="floating-label-group">
                                        <select id="addressType" 
                                                required
                                                class="floating-input w-full p-4 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition appearance-none bg-white">
                                            <option value="" disabled selected>Address Type</option>
                                            <option value="Flat">Flat</option>
                                            <option value="House">House</option>
                                            <option value="Office">Office</option>
                                            <option value="Hostel">Hostel</option>
                                            <option value="PG">P.G.</option>
                                        </select>
                                        <label class="floating-label">Address Type *</label>
                                    </div>
                                </div>
                                
                                <!-- House Number -->
                                <div>
                                    <div class="floating-label-group">
                                        <input type="text" 
                                               id="houseNumber" 
                                               required
                                               class="floating-input w-full p-4 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition"
                                               placeholder="House/Flat No.">
                                        <label class="floating-label">House/Flat No. *</label>
                                    </div>
                                </div>
                                
                                <!-- Floor Number -->
                                <div>
                                    <div class="floating-label-group">
                                        <input type="text" 
                                               id="floorNumber"
                                               class="floating-input w-full p-4 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition"
                                               placeholder="Floor No.">
                                        <label class="floating-label">Floor No.</label>
                                    </div>
                                </div>
                                
                                <!-- Locality -->
                                <div class="md:col-span-2">
                                    <div class="floating-label-group">
                                        <input type="text" 
                                               id="locality" 
                                               required
                                               class="floating-input w-full p-4 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition"
                                               placeholder="Locality">
                                        <label class="floating-label">Locality *</label>
                                    </div>
                                </div>
                                
                                <!-- Street -->
                                <div class="md:col-span-2">
                                    <div class="floating-label-group">
                                        <input type="text" 
                                               id="street" 
                                               required
                                               class="floating-input w-full p-4 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition"
                                               placeholder="Street Name">
                                        <label class="floating-label">Street Name *</label>
                                    </div>
                                </div>
                                
                                <!-- Pincode -->
                                <div>
                                    <div class="floating-label-group">
                                        <input type="text" 
                                               id="pincode" 
                                               required
                                               maxlength="6"
                                               pattern="[0-9]{6}"
                                               class="floating-input w-full p-4 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition"
                                               placeholder="Pincode">
                                        <label class="floating-label">Pincode *</label>
                                    </div>
                                </div>
                                
                                <!-- City -->
                                <div>
                                    <div class="floating-label-group">
                                        <input type="text" 
                                               id="city" 
                                               readonly
                                               class="w-full p-4 border-2 border-gray-300 rounded-xl bg-gray-50 text-gray-600"
                                               placeholder="City">
                                        <label class="floating-label">City</label>
                                    </div>
                                </div>
                                
                                <!-- State -->
                                <div class="md:col-span-2">
                                    <div class="floating-label-group">
                                        <input type="text" 
                                               id="state" 
                                               readonly
                                               class="w-full p-4 border-2 border-gray-300 rounded-xl bg-gray-50 text-gray-600"
                                               placeholder="State">
                                        <label class="floating-label">State</label>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Takeaway Form (Only Name & Phone) -->
                    <div id="takeaway-form-section" class="glass-card rounded-2xl p-8 hidden">
                        <div class="flex items-center gap-3 mb-6">
                            <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center">
                                <i class="fas fa-store text-green-600 text-xl"></i>
                            </div>
                            <h2 class="text-2xl font-bold text-gray-800">Takeaway Details</h2>
                        </div>
                        
                        <div class="mb-6 p-6 bg-green-50 border-2 border-green-200 rounded-xl">
                            <h3 class="font-bold text-green-800 mb-3">Pickup Information</h3>
                            <div class="space-y-3 text-green-700">
                                <p class="flex items-center gap-2">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span><strong>Address:</strong> Prime Square, Omaxe City 1, Indore</span>
                                </p>
                                <p class="flex items-center gap-2">
                                    <i class="fas fa-clock"></i>
                                    <span><strong>Timings:</strong> 6:00 PM - 10:00 PM</span>
                                </p>
                                <p class="flex items-center gap-2">
                                    <i class="fas fa-mobile-alt"></i>
                                    <span><strong>OTP Verification:</strong> Required at pickup</span>
                                </p>
                            </div>
                        </div>
                        
                        <form id="takeawayForm" class="space-y-6">
                            <div>
                                <div class="floating-label-group">
                                    <input type="text" 
                                           id="takeaway-name" 
                                           required
                                           class="floating-input w-full p-4 border-2 border-gray-300 rounded-xl focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition"
                                           placeholder="Your Name">
                                    <label class="floating-label">Your Name *</label>
                                </div>
                            </div>
                            
                            <div>
                                <div class="floating-label-group">
                                    <input type="tel" 
                                           id="takeaway-phone" 
                                           required
                                           pattern="[0-9]{10}"
                                           class="floating-input w-full p-4 border-2 border-gray-300 rounded-xl focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition"
                                           placeholder="Phone Number">
                                    <label class="floating-label">Phone Number *</label>
                                </div>
                                <p class="text-sm text-gray-500 mt-2">This number will be used for OTP verification at pickup</p>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Location Button (Only for Delivery) -->
                    <div id="location-section" class="glass-card rounded-2xl p-8">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Set Your Location</h3>
                        <p class="text-gray-600 mb-6">Click below to set your location for delivery charge calculation.</p>
                        
                        <button id="getLocationBtn" 
                                class="w-full flex items-center justify-center gap-3 p-5 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-bold rounded-xl hover:opacity-90 transition-all btn-pulse">
                            <i class="fas fa-map-marker-alt text-xl"></i>
                            <span class="text-lg">Set Delivery Location</span>
                        </button>
                        
                        <div class="mt-4 flex gap-4">
                            <button id="useCurrentLocationBtn" 
                                    class="flex-1 flex items-center justify-center gap-2 p-4 bg-blue-50 border-2 border-blue-200 text-blue-700 rounded-xl hover:bg-blue-100 transition">
                                <i class="fas fa-location-crosshairs"></i>
                                <span>Auto Location</span>
                            </button>
                            
                            <button id="manualLocationBtn" 
                                    class="flex-1 flex items-center justify-center gap-2 p-4 bg-purple-50 border-2 border-purple-200 text-purple-700 rounded-xl hover:bg-purple-100 transition">
                                <i class="fas fa-map-pin"></i>
                                <span>Manual Pin</span>
                            </button>
                        </div>
                        
                        <!-- Location Status -->
                        <div id="locationStatus" class="mt-6 p-4 bg-green-50 border-2 border-green-200 rounded-xl hidden">
                            <div class="flex items-center gap-3">
                                <i class="fas fa-check-circle text-2xl text-green-500"></i>
                                <div>
                                    <p class="font-bold text-green-700">Location Set Successfully</p>
                                    <p class="text-sm text-gray-600">Distance: <span id="previewDistance" class="font-bold">-- km</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Right Column -->
                <div class="space-y-8">
                    <!-- Map Container -->
                    <div id="map-section" class="glass-card rounded-2xl p-8">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-gray-800">Location Map</h2>
                            <div class="flex items-center gap-4 text-sm text-gray-600">
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
                                    <span>Restaurant</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 bg-purple-500 rounded-full"></div>
                                    <span>Your Location</span>
                                </div>
                            </div>
                        </div>
                        
                        <div id="map"></div>
                        
                        <!-- Location Link -->
                        <div id="locationLinkContainer" class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-xl hidden">
                            <div class="flex items-center justify-between gap-4">
                                <div class="flex-1 min-w-0">
                                    <p class="text-sm font-medium text-blue-800 mb-1">Delivery Location:</p>
                                    <a id="locationLink" href="#" target="_blank" class="text-blue-600 text-sm truncate block hover:underline"></a>
                                </div>
                                <button id="copyLinkBtn" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition flex-shrink-0">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Delivery Charges Card -->
                    <div id="deliveryChargesCard" class="glass-card rounded-2xl p-8 hidden">
                        <div class="flex items-center gap-3 mb-6">
                            <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center">
                                <i class="fas fa-truck text-blue-600 text-xl"></i>
                            </div>
                            <h2 class="text-2xl font-bold text-gray-800">Delivery Summary</h2>
                        </div>
                        
                        <!-- Distance Display -->
                        <div class="mb-6 p-5 bg-gradient-to-r from-blue-50 to-blue-100 border-2 border-blue-200 rounded-xl">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-gray-700">Distance from Prime Square</p>
                                    <p class="text-sm text-blue-600">Your delivery location</p>
                                </div>
                                <span id="distanceValue" class="text-3xl font-bold text-blue-700">-- km</span>
                            </div>
                        </div>
                        
                        <!-- Charges Breakdown -->
                        <div class="space-y-4">
                            <div class="flex justify-between items-center p-4 bg-gray-50 rounded-xl">
                                <span class="font-medium text-gray-700">Base Fare</span>
                                <span id="baseFare" class="font-bold text-gray-800 text-lg">â‚¹0</span>
                            </div>
                            
                            <div class="flex justify-between items-center p-4 bg-gray-50 rounded-xl">
                                <span class="font-medium text-gray-700">GST (18%)</span>
                                <span id="gstValue" class="font-bold text-gray-800 text-lg">â‚¹0</span>
                            </div>
                            
                            <div class="border-t border-gray-200 pt-4">
                                <div class="flex justify-between items-center p-5 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl">
                                    <div>
                                        <p class="font-bold text-gray-800 text-lg">Total Delivery Charge</p>
                                        <p class="text-sm text-green-600">Inclusive of all taxes</p>
                                    </div>
                                    <span id="totalCharge" class="font-bold text-green-700 text-3xl">â‚¹0</span>
                                </div>
                            </div>
                            
                            <!-- Free Delivery Offer -->
                            <div id="freeDeliveryOffer" class="p-4 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl hidden">
                                <div class="flex items-center gap-3">
                                    <i class="fas fa-gift text-green-500 text-xl"></i>
                                    <div>
                                        <p class="font-bold text-green-800">ðŸŽ‰ FREE DELIVERY!</p>
                                        <p class="text-sm text-green-700">Your order qualifies for free delivery</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Range Warning -->
                            <div id="rangeWarning" class="p-4 bg-red-50 border-2 border-red-200 rounded-xl hidden">
                                <div class="flex items-center gap-3">
                                    <i class="fas fa-exclamation-triangle text-red-500 text-xl"></i>
                                    <div>
                                        <p class="font-bold text-red-800">Beyond Delivery Range</p>
                                        <p class="text-sm text-red-700">Please select takeaway option</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Action Button -->
                        <button id="proceedToPaymentBtn" 
                                class="w-full mt-8 flex items-center justify-center gap-3 p-5 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold rounded-xl hover:opacity-90 transition-all shadow-lg">
                            <i class="fas fa-check-circle text-xl"></i>
                            <span class="text-lg">Proceed to Payment</span>
                        </button>
                    </div>
                    
                    <!-- Takeaway Action Card -->
                    <div id="takeawayActionCard" class="glass-card rounded-2xl p-8 hidden">
                        <div class="flex items-center gap-3 mb-6">
                            <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center">
                                <i class="fas fa-store text-green-600 text-xl"></i>
                            </div>
                            <h2 class="text-2xl font-bold text-gray-800">Takeaway Ready</h2>
                        </div>
                        
                        <div class="mb-6 p-5 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl">
                            <div class="space-y-4">
                                <div class="flex items-center gap-3">
                                    <i class="fas fa-map-marker-alt text-green-500"></i>
                                    <div>
                                        <p class="text-sm text-gray-600">Pickup Location</p>
                                        <p class="font-bold text-green-700">Prime Square, Omaxe City 1, Indore</p>
                                    </div>
                                </div>
                                <div class="flex items-center gap-3">
                                    <i class="fas fa-clock text-green-500"></i>
                                    <div>
                                        <p class="text-sm text-gray-600">Pickup Time</p>
                                        <p class="font-bold text-green-700">6:00 PM - 10:00 PM</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <button id="proceedToPaymentTakeawayBtn" 
                                class="w-full flex items-center justify-center gap-3 p-5 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold rounded-xl hover:opacity-90 transition-all shadow-lg">
                            <i class="fas fa-check-circle text-xl"></i>
                            <span class="text-lg">Proceed to Payment</span>
                        </button>
                        
                        <button id="switchToDeliveryBtn" 
                                class="w-full mt-4 flex items-center justify-center gap-3 p-4 bg-blue-50 border-2 border-blue-200 text-blue-700 font-bold rounded-xl hover:bg-blue-100 transition">
                            <i class="fas fa-motorcycle"></i>
                            <span>Switch to Delivery</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Footer -->
            <footer class="bg-gray-900 text-white py-8 mt-12">
                <div class="max-w-6xl mx-auto px-4">
                    <div class="flex flex-col md:flex-row justify-between items-center">
                        <div class="mb-6 md:mb-0">
                            <div class="flex items-center">
                                <img src="https://raw.githubusercontent.com/Clean-Scripts/EasyGo-Expense-Tracker/refs/heads/main/logo.png" 
                                     class="h-12 w-12 rounded-full bg-white p-1 mr-3">
                                <div>
                                    <h2 class="text-xl font-bold">Easy Go</h2>
                                    <p class="text-gray-400 text-sm">Freshness & Speed Delivered</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-center md:text-right">
                            <p class="text-gray-400 text-sm mb-2">
                                Â© 2024 Easy Go + All Rights Reserved
                            </p>
                            <p class="text-gray-500 text-xs">
                                Serving daily from 5:00 PM to 10:00 PM
                            </p>
                            <div class="mt-4">
                                <a href="https://clean-scripts.github.io/Easygo-Menu/" class="text-gray-400 hover:text-white text-sm mr-4">View Menu</a>
                                <a href="#" class="text-gray-400 hover:text-white text-sm mr-4">Privacy Policy</a>
                                <a href="#" class="text-gray-400 hover:text-white text-sm">Terms & Conditions</a>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-10 rounded-2xl shadow-2xl text-center max-w-sm">
            <div class="loader mx-auto mb-6"></div>
            <p class="text-xl font-bold text-gray-800 mb-2">Processing Your Request</p>
            <p class="text-gray-600">Please wait while we verify your details...</p>
        </div>
    </div>

<script>
    // Global variables
    let map;
    let userMarker;
    let userLocation = null;
    let deliveryMode = 'delivery';
    let googleMapsLink = "";
    
    // Restaurant location
    const primeSquareLocation = [22.7767737, 75.9605483];
    
    // ====== FIXED: CHECK IF CART IS EMPTY ======
    function checkCartEmpty() {
        try {
            const cart = JSON.parse(localStorage.getItem('easygo-cart') || '[]');
            const cartTotal = parseFloat(localStorage.getItem('easygo-cart-items-total') || '0');
            
            console.log("Cart check:", cart.length, "items, total:", cartTotal);
            
            if (cart.length === 0 || cartTotal <= 0) {
                // Show empty cart overlay
                document.getElementById('emptyCartOverlay').classList.remove('hidden');
                
                // Start countdown
                let seconds = 5;
                const countdownElement = document.getElementById('countdown');
                
                const countdown = setInterval(() => {
                    seconds--;
                    countdownElement.textContent = seconds;
                    
                    if (seconds <= 0) {
                        clearInterval(countdown);
                        window.location.href = 'https://clean-scripts.github.io/Easygo-Menu/';
                    }
                }, 1000);
                
                return true;
            }
            
            return false;
        } catch (error) {
            console.error("Error checking cart:", error);
            return false;
        }
    }
    
    // ====== FIXED: Load saved address ======
    function loadSavedAddress() {
        try {
            const savedAddress = JSON.parse(localStorage.getItem('easygo-saved-address') || '{}');
            
            if (savedAddress.name) {
                document.getElementById('name').value = savedAddress.name;
                document.getElementById('phone').value = savedAddress.phone;
                document.getElementById('addressType').value = savedAddress.addressType || 'House';
                document.getElementById('houseNumber').value = savedAddress.houseNumber || '';
                document.getElementById('floorNumber').value = savedAddress.floorNumber || '';
                document.getElementById('locality').value = savedAddress.locality || '';
                document.getElementById('street').value = savedAddress.street || '';
                document.getElementById('pincode').value = savedAddress.pincode || '';
                
                if (savedAddress.city) {
                    document.getElementById('city').value = savedAddress.city;
                }
                if (savedAddress.state) {
                    document.getElementById('state').value = savedAddress.state;
                }
                
                console.log("Loaded saved address:", savedAddress);
            }
        } catch (error) {
            console.error("Error loading saved address:", error);
        }
    }
    
    // ====== FIXED: Save address permanently ======
    function saveAddressToStorage(address) {
        try {
            // Save current address
            localStorage.setItem('easygo-address', JSON.stringify(address));
            
            // Save to permanent storage (for future use)
            localStorage.setItem('easygo-saved-address', JSON.stringify(address));
            
            console.log("Address saved permanently:", address);
        } catch (error) {
            console.error("Error saving address:", error);
        }
    }
    
    // ====== NEW: Reverse geocoding to auto-fill address ======
    async function reverseGeocode(lat, lng) {
        try {
            document.getElementById('loadingOverlay').classList.remove('hidden');
            
            // Using Nominatim (OpenStreetMap) for reverse geocoding
            const response = await fetch(
                `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1`
            );
            
            if (!response.ok) {
                throw new Error('Geocoding failed');
            }
            
            const data = await response.json();
            
            if (data.address) {
                const address = data.address;
                
                // Auto-fill form fields
                document.getElementById('locality').value = address.neighbourhood || address.suburb || address.city_district || '';
                document.getElementById('street').value = address.road || address.footway || '';
                
                if (address.postcode) {
                    document.getElementById('pincode').value = address.postcode;
                    
                    // Trigger pincode lookup
                    setTimeout(() => {
                        if (address.postcode.length === 6) {
                            document.getElementById('city').value = address.city || address.town || address.village || 'Indore';
                            document.getElementById('state').value = address.state || 'Madhya Pradesh';
                        }
                    }, 100);
                }
                
                // Suggest house number if available
                if (address.house_number) {
                    document.getElementById('houseNumber').value = address.house_number;
                }
                
                console.log("Auto-filled address from geocoding:", address);
            }
            
            document.getElementById('loadingOverlay').classList.add('hidden');
            
        } catch (error) {
            console.error("Reverse geocoding error:", error);
            document.getElementById('loadingOverlay').classList.add('hidden');
            // Continue without auto-fill if geocoding fails
        }
    }
    
    // ====== FIXED: Initialize on load ======
    document.addEventListener('DOMContentLoaded', function() {
        // Check cart first
        if (checkCartEmpty()) {
            return;
        }
        
        // Load saved address
        loadSavedAddress();
        
        // Initialize map IMMEDIATELY
        initMap();
        
        // Load cart total
        loadCartTotal();
        
        // Set default mode
        switchToDelivery();
        
        // Pincode lookup
        document.getElementById('pincode').addEventListener('input', function() {
            const pincode = this.value;
            if (pincode.length === 6) {
                document.getElementById('city').value = "Indore";
                document.getElementById('state').value = "Madhya Pradesh";
            }
        });
        
        // Event listeners
        document.getElementById('getLocationBtn').addEventListener('click', getCurrentLocation);
        document.getElementById('useCurrentLocationBtn').addEventListener('click', getCurrentLocation);
        
        document.getElementById('manualLocationBtn').addEventListener('click', function() {
            if (deliveryMode === 'takeaway') return;
            alert('Click on the map to set your delivery location');
            map.once('click', function(e) {
                setUserLocation(e.latlng.lat, e.latlng.lng);
            });
        });
        
        // Copy location link
        document.getElementById('copyLinkBtn').addEventListener('click', function() {
            navigator.clipboard.writeText(googleMapsLink);
            this.innerHTML = '<i class="fas fa-check"></i> Copied!';
            this.classList.add('bg-green-500');
            setTimeout(() => {
                this.innerHTML = '<i class="fas fa-copy"></i>';
                this.classList.remove('bg-green-500');
                this.classList.add('bg-blue-500');
            }, 2000);
        });
        
        // Proceed to payment (delivery)
        document.getElementById('proceedToPaymentBtn').addEventListener('click', function() {
            if (!validateForm()) return;
            if (deliveryMode === 'delivery' && !userLocation) {
                alert('Please set your delivery location first');
                return;
            }
            saveAddressToStorage(getAddressData());
            window.location.href = 'https://clean-scripts.github.io/Easygo-Payment/';
        });
        
        // Proceed to payment (takeaway)
        document.getElementById('proceedToPaymentTakeawayBtn').addEventListener('click', function() {
            if (!validateForm()) return;
            saveAddressToStorage(getTakeawayData());
            window.location.href = 'https://clean-scripts.github.io/Easygo-Payment/';
        });
        
        // Switch to delivery from takeaway
        document.getElementById('switchToDeliveryBtn').addEventListener('click', switchToDelivery);
        
        console.log("Page initialized successfully");
    });
    
    // ====== FIXED: Get address data ======
    function getAddressData() {
        return {
            name: document.getElementById('name').value,
            phone: document.getElementById('phone').value,
            addressType: document.getElementById('addressType').value,
            houseNumber: document.getElementById('houseNumber').value,
            floorNumber: document.getElementById('floorNumber').value,
            locality: document.getElementById('locality').value,
            street: document.getElementById('street').value,
            pincode: document.getElementById('pincode').value,
            city: document.getElementById('city').value || 'Indore',
            state: document.getElementById('state').value || 'Madhya Pradesh',
            deliveryMode: 'delivery'
        };
    }
    
    // ====== FIXED: Get takeaway data ======
    function getTakeawayData() {
        return {
            name: document.getElementById('takeaway-name').value,
            phone: document.getElementById('takeaway-phone').value,
            pickupLocation: 'Prime Square, Omaxe City 1, Indore',
            timings: '6:00 PM - 10:00 PM',
            deliveryMode: 'takeaway'
        };
    }
    
    // ====== FIXED: Initialize map ======
    function initMap(lat = primeSquareLocation[0], lng = primeSquareLocation[1]) {
        try {
            const mapContainer = document.getElementById('map');
            if (!mapContainer) {
                console.error("Map container not found!");
                return;
            }
            
            // Check if map already exists
            if (map) {
                map.remove();
            }
            
            // Initialize map
            map = L.map('map', {
                center: [lat, lng],
                zoom: 14,
                zoomControl: true,
                scrollWheelZoom: true
            });
            
            // Add tile layer
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap contributors',
                maxZoom: 19
            }).addTo(map);
            
            // Add restaurant marker
            L.marker(primeSquareLocation, {
                icon: L.divIcon({
                    className: 'custom-marker',
                    html: '<div style="background: #3b82f6; width: 30px; height: 30px; border-radius: 50%; border: 3px solid white; box-shadow: 0 4px 10px rgba(0,0,0,0.3);"></div>',
                    iconSize: [30, 30],
                    iconAnchor: [15, 30]
                })
            }).addTo(map)
                .bindPopup('<b>Prime Square, EasyGo Restaurant</b>')
                .openPopup();
                
            // Add delivery range circles
            L.circle(primeSquareLocation, {
                color: '#3b82f6',
                fillColor: '#3b82f6',
                fillOpacity: 0.1,
                radius: 4000,
                weight: 2
            }).addTo(map).bindPopup('4km delivery zone');
            
            L.circle(primeSquareLocation, {
                color: '#f59e0b',
                fillColor: '#f59e0b',
                fillOpacity: 0.05,
                radius: 10000,
                weight: 1
            }).addTo(map).bindPopup('10km delivery range');
            
            // Add click event for manual pin drop
            map.on('click', function(e) {
                if (deliveryMode === 'delivery') {
                    setUserLocation(e.latlng.lat, e.latlng.lng);
                }
            });
            
            console.log("Map initialized successfully");
            
        } catch (error) {
            console.error("Error initializing map:", error);
            // Show fallback message
            const mapContainer = document.getElementById('map');
            if (mapContainer) {
                mapContainer.innerHTML = `
                    <div class="h-full flex flex-col items-center justify-center bg-gray-100 rounded-xl p-8">
                        <div class="text-4xl mb-4">ðŸ—ºï¸</div>
                        <p class="font-bold text-gray-700">Map Loading Error</p>
                        <p class="text-gray-600 text-sm mt-2">Please refresh the page or check your internet connection</p>
                        <button onclick="initMap()" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                            Retry Loading Map
                        </button>
                    </div>
                `;
            }
        }
    }
    
    // ====== FIXED: Set user location ======
    async function setUserLocation(lat, lng) {
        try {
            userLocation = { lat, lng };
            
            // Remove existing user marker
            if (userMarker) {
                map.removeLayer(userMarker);
            }
            
            // Create new user marker
            userMarker = L.marker([lat, lng], { 
                draggable: true,
                icon: L.divIcon({
                    className: 'custom-marker',
                    html: '<div style="background: #8b5cf6; width: 40px; height: 40px; border-radius: 50%; border: 3px solid white; box-shadow: 0 4px 10px rgba(0,0,0,0.3);"></div>',
                    iconSize: [40, 40],
                    iconAnchor: [20, 40]
                })
            }).addTo(map);
            
            // Center map on user location
            map.setView([lat, lng], 16);
            
            // Auto-fill address using reverse geocoding
            await reverseGeocode(lat, lng);
            
            // Update delivery charges
            updateDeliveryCharges();
            
            // Show location status
            document.getElementById('locationStatus').classList.remove('hidden');
            document.getElementById('loadingOverlay').classList.add('hidden');
            
            // Add dragend event for marker
            userMarker.on('dragend', function() {
                const position = userMarker.getLatLng();
                userLocation = { lat: position.lat, lng: position.lng };
                updateDeliveryCharges();
            });
            
            console.log("User location set:", { lat, lng });
            
        } catch (error) {
            console.error("Error setting user location:", error);
            alert("Error setting location. Please try again.");
            document.getElementById('loadingOverlay').classList.add('hidden');
        }
    }
    
    // Calculate distance
    function calculateDistance(lat1, lon1, lat2, lon2) {
        const R = 6371;
        const dLat = (lat2 - lat1) * Math.PI / 180;
        const dLon = (lon2 - lon1) * Math.PI / 180;
        const a = 
            Math.sin(dLat/2) * Math.sin(dLat/2) +
            Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
            Math.sin(dLon/2) * Math.sin(dLon/2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
        return R * c;
    }
    
    // Calculate delivery charges
    function calculateDeliveryCharges(distance) {
        const cartTotal = parseFloat(localStorage.getItem('easygo-cart-items-total')) || 0;
        const freeDeliveryEligible = cartTotal > 199;
        
        if (distance > 10) {
            return { beyondRange: true, distance: distance.toFixed(2) };
        }
        
        let baseCharge = 0;
        
        if (distance <= 4) {
            if (freeDeliveryEligible) {
                baseCharge = 0;
            } else {
                baseCharge = Math.ceil(distance * 2);
            }
        } else if (distance <= 10) {
            const extraKm = distance - 4;
            baseCharge = Math.ceil(4 * 2 + extraKm * 3);
        }
        
        const gst = baseCharge * 0.18;
        const totalCharge = baseCharge + gst;
        
        return {
            distance: distance.toFixed(2),
            baseCharge: baseCharge,
            gst: gst.toFixed(2),
            totalCharge: totalCharge.toFixed(2),
            freeDelivery: freeDeliveryEligible && distance <= 4,
            beyondRange: false
        };
    }
    
    // Generate Google Maps link
    function generateGoogleMapsLink(lat, lng) {
        return `https://www.google.com/maps?q=${lat},${lng}`;
    }
    
    // Update delivery charges display
    function updateDeliveryCharges() {
        if (!userLocation) return;
        
        const distance = calculateDistance(
            primeSquareLocation[0], primeSquareLocation[1],
            userLocation.lat, userLocation.lng
        );
        
        const charges = calculateDeliveryCharges(distance);
        
        if (charges.beyondRange) {
            document.getElementById('rangeWarning').classList.remove('hidden');
            document.getElementById('freeDeliveryOffer').classList.add('hidden');
            document.getElementById('proceedToPaymentBtn').disabled = true;
            document.getElementById('proceedToPaymentBtn').classList.add('opacity-50', 'cursor-not-allowed');
            return;
        }
        
        document.getElementById('rangeWarning').classList.add('hidden');
        document.getElementById('proceedToPaymentBtn').disabled = false;
        document.getElementById('proceedToPaymentBtn').classList.remove('opacity-50', 'cursor-not-allowed');
        
        // Update UI
        document.getElementById('distanceValue').textContent = `${charges.distance} km`;
        document.getElementById('previewDistance').textContent = `${charges.distance} km`;
        document.getElementById('baseFare').textContent = `â‚¹${charges.baseCharge}`;
        document.getElementById('gstValue').textContent = `â‚¹${charges.gst}`;
        document.getElementById('totalCharge').textContent = `â‚¹${charges.totalCharge}`;
        
        if (charges.freeDelivery) {
            document.getElementById('freeDeliveryOffer').classList.remove('hidden');
        } else {
            document.getElementById('freeDeliveryOffer').classList.add('hidden');
        }
        
        // Generate location link
        googleMapsLink = generateGoogleMapsLink(userLocation.lat, userLocation.lng);
        document.getElementById('locationLink').textContent = googleMapsLink;
        document.getElementById('locationLink').href = googleMapsLink;
        document.getElementById('locationLinkContainer').classList.remove('hidden');
        document.getElementById('deliveryChargesCard').classList.remove('hidden');
        
        // Save delivery data
        const deliveryData = {
            mode: 'delivery',
            distance: charges.distance,
            charge: charges.totalCharge,
            location: userLocation,
            locationLink: googleMapsLink
        };
        localStorage.setItem('easygo-delivery', JSON.stringify(deliveryData));
    }
    
    // Get current location
    function getCurrentLocation() {
        if (deliveryMode === 'takeaway') {
            alert("Takeaway doesn't require location. Please proceed with payment.");
            return;
        }
        
        document.getElementById('loadingOverlay').classList.remove('hidden');
        
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                async (position) => {
                    await setUserLocation(position.coords.latitude, position.coords.longitude);
                },
                (error) => {
                    document.getElementById('loadingOverlay').classList.add('hidden');
                    console.error("Geolocation error:", error);
                    
                    if (error.code === error.PERMISSION_DENIED) {
                        alert("Location access denied. Please allow location access or use manual pin drop.");
                    } else {
                        alert("Unable to get location. Please use manual pin drop.");
                    }
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                }
            );
        } else {
            document.getElementById('loadingOverlay').classList.add('hidden');
            alert("Geolocation is not supported by your browser. Please use manual pin drop.");
        }
    }
    
    // Validate form based on mode
    function validateForm() {
        if (deliveryMode === 'delivery') {
            const requiredFields = ['name', 'phone', 'addressType', 'houseNumber', 'locality', 'street', 'pincode'];
            let isValid = true;
            
            for (const fieldId of requiredFields) {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                    field.classList.add('shake', 'border-red-500');
                    setTimeout(() => field.classList.remove('shake'), 500);
                    if (isValid) {
                        field.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        isValid = false;
                    }
                } else {
                    field.classList.remove('border-red-500');
                }
            }
            
            if (!isValid) {
                alert('Please fill all required delivery address fields');
                return false;
            }
            
            const phone = document.getElementById('phone').value;
            if (!/^\d{10}$/.test(phone)) {
                alert('Please enter valid 10-digit phone number');
                document.getElementById('phone').classList.add('border-red-500');
                return false;
            }
            
            const pincode = document.getElementById('pincode').value;
            if (!/^\d{6}$/.test(pincode)) {
                alert('Please enter valid 6-digit pincode');
                document.getElementById('pincode').classList.add('border-red-500');
                return false;
            }
            
            return true;
            
        } else if (deliveryMode === 'takeaway') {
            const name = document.getElementById('takeaway-name').value;
            const phone = document.getElementById('takeaway-phone').value;
            
            if (!name.trim()) {
                alert('Please enter your name for takeaway');
                document.getElementById('takeaway-name').classList.add('border-red-500');
                return false;
            }
            
            if (!/^\d{10}$/.test(phone)) {
                alert('Please enter valid 10-digit phone number for OTP verification');
                document.getElementById('takeaway-phone').classList.add('border-red-500');
                return false;
            }
            
            document.getElementById('takeaway-name').classList.remove('border-red-500');
            document.getElementById('takeaway-phone').classList.remove('border-red-500');
            return true;
        }
        
        return false;
    }
    
    // Switch to delivery mode
    function switchToDelivery() {
        deliveryMode = 'delivery';
        
        // Update UI
        document.getElementById('delivery-option').classList.add('border-blue-500', 'bg-blue-50');
        document.getElementById('delivery-option').classList.remove('border-gray-200');
        document.getElementById('takeaway-option').classList.add('border-gray-200');
        document.getElementById('takeaway-option').classList.remove('border-green-500', 'bg-green-50');
        
        // Show delivery form, hide takeaway form
        document.getElementById('address-form-section').classList.remove('hidden');
        document.getElementById('takeaway-form-section').classList.add('hidden');
        document.getElementById('location-section').classList.remove('hidden');
        document.getElementById('map-section').classList.remove('hidden');
        document.getElementById('deliveryChargesCard').classList.add('hidden');
        document.getElementById('takeawayActionCard').classList.add('hidden');
        
        // Ensure map is visible
        setTimeout(() => {
            if (map) {
                map.invalidateSize();
            }
        }, 300);
    }
    
    // Switch to takeaway mode
    function switchToTakeaway() {
        deliveryMode = 'takeaway';
        
        // Update UI
        document.getElementById('takeaway-option').classList.add('border-green-500', 'bg-green-50');
        document.getElementById('takeaway-option').classList.remove('border-gray-200');
        document.getElementById('delivery-option').classList.add('border-gray-200');
        document.getElementById('delivery-option').classList.remove('border-blue-500', 'bg-blue-50');
        
        // Hide delivery form, show takeaway form
        document.getElementById('address-form-section').classList.add('hidden');
        document.getElementById('takeaway-form-section').classList.remove('hidden');
        document.getElementById('location-section').classList.add('hidden');
        document.getElementById('map-section').classList.add('hidden');
        document.getElementById('deliveryChargesCard').classList.add('hidden');
        document.getElementById('takeawayActionCard').classList.remove('hidden');
        
        // Save takeaway data
        localStorage.setItem('easygo-delivery', JSON.stringify({
            mode: 'takeaway',
            charge: 0
        }));
    }
    
    // Load cart total
    function loadCartTotal() {
        const cartTotal = localStorage.getItem('easygo-cart-items-total') || '0';
        document.getElementById('cart-total-badge').textContent = `â‚¹${cartTotal}`;
    }
</script>
    
</body>
</html>

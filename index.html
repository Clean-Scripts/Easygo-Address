<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EasyGo | Delivery Charges</title>
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="https://raw.githubusercontent.com/Clean-Scripts/EasyGo-Address/refs/heads/main/logo.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        .map-container {
            height: 300px;
            width: 100%;
            border-radius: 0.75rem;
            z-index: 1;
        }
        .loader {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
        .slide-in {
            animation: slideIn 0.5s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        /* Banner Background */
        .banner-bg {
            background-image: url('https://raw.githubusercontent.com/Clean-Scripts/EasyGo-Address/refs/heads/main/Banner.png');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            position: relative;
        }
        .content-wrapper {
            position: relative;
            z-index: 1;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        .security-note {
            border-left: 4px solid #ef4444;
            background-color: #fef2f2;
            padding: 1rem;
            margin: 1rem 0;
        }
        .input-highlight {
            transition: all 0.3s ease;
        }
        .input-highlight:focus {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        .step-indicator {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 10px;
        }
        .step-active {
            background-color: #3b82f6;
            color: white;
        }
        .step-inactive {
            background-color: #e5e7eb;
            color: #6b7280;
        }
        .floating-label {
            position: relative;
            margin-bottom: 20px;
        }
        .floating-label input:focus ~ label,
        .floating-label input:not(:placeholder-shown) ~ label {
            top: -10px;
            font-size: 12px;
            color: #3b82f6;
            background: white;
            padding: 0 5px;
        }
        .floating-label label {
            position: absolute;
            left: 12px;
            top: 12px;
            color: #6b7280;
            transition: all 0.3s;
            pointer-events: none;
        }
        .shake {
            animation: shake 0.5s;
        }
        @keyframes shake {
            0%, 100% {transform: translateX(0);}
            10%, 30%, 50%, 70%, 90% {transform: translateX(-5px);}
            20%, 40%, 60%, 80% {transform: translateX(5px);}
        }
    </style>
</head>
<body class="min-h-screen banner-bg">
    
    <div class="content-wrapper min-h-screen p-4 md:p-6">
        <div class="max-w-6xl mx-auto">
            <!-- Header with Logo -->
            <header class="mb-8 text-center">
                <div class="flex flex-col items-center mb-4">
                    <!-- Logo -->
                    <div class="flex items-center justify-center gap-4 mb-6">
                        <div class="w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-500 rounded-2xl flex items-center justify-center shadow-2xl transform hover:scale-105 transition-transform duration-300">
                            <img src="https://raw.githubusercontent.com/Clean-Scripts/EasyGo-Address/refs/heads/main/logo.png" 
                                 alt="EasyGo Logo" class="w-14 h-14 object-contain" onerror="this.style.display='none'">
                        </div>
                        <div class="text-left">
                            <h1 class="text-4xl md:text-5xl font-bold text-white mb-2 drop-shadow-lg">EasyGo-Address</h1>
                            <p class="text-white/90 text-lg">üöÄ Smart Delivery Solutions</p>
                        </div>
                    </div>
                </div>
                
                <!-- Progress Bar -->
                <div class="max-w-md mx-auto mb-6">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-white text-sm">Step 1: Cart</span>
                        <span class="text-white text-sm">Step 2: Address</span>
                        <span class="text-white text-sm">Step 3: Payment</span>
                    </div>
                    <div class="w-full bg-white/30 h-2 rounded-full overflow-hidden">
                        <div id="progressBar" class="h-full bg-gradient-to-r from-green-400 to-blue-500 transition-all duration-500" style="width: 66%"></div>
                    </div>
                </div>
            </header>

            <div class="flex flex-col lg:flex-row gap-8">
                <!-- Left Column: Address Form -->
                <div class="lg:w-1/2">
                    <div class="bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 mb-6 slide-in border border-white/20">
                        <div class="flex items-center justify-between mb-8">
                            <h2 class="text-3xl font-bold text-gray-800 flex items-center">
                                <i class="fas fa-map-marker-alt text-blue-500 mr-3 bg-blue-100 p-3 rounded-full"></i>
                                Address Details
                            </h2>
                            <div id="cart-summary-badge" class="hidden">
                                <div class="flex items-center gap-2 bg-gradient-to-r from-green-100 to-emerald-100 text-green-800 px-4 py-2 rounded-full shadow">
                                    <i class="fas fa-shopping-cart text-green-600"></i>
                                    <span class="font-bold" id="cart-items-count">0 items</span>
                                    <span id="cart-total-badge" class="bg-green-600 text-white px-2 py-1 rounded-full text-sm">‚Çπ0</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Address Form -->
                        <form id="addressForm" class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Name -->
                                <div class="md:col-span-2">
                                    <div class="floating-label">
                                        <input type="text" id="name" required 
                                               class="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition input-highlight"
                                               placeholder=" "
                                               pattern="[A-Za-z\s]{3,}">
                                        <label for="name">
                                            <i class="fas fa-user text-blue-500 mr-2"></i>Full Name *
                                        </label>
                                    </div>
                                    <div class="text-sm text-gray-500 mt-2 flex items-center">
                                        <i class="fas fa-star text-red-400 mr-1"></i>
                                        <span>Required field</span>
                                    </div>
                                </div>
                                
                                <!-- Phone Number -->
                                <div class="md:col-span-2">
                                    <div class="floating-label">
                                        <input type="tel" id="phone" required 
                                               class="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition input-highlight"
                                               placeholder=" "
                                               pattern="[0-9]{10}">
                                        <label for="phone">
                                            <i class="fas fa-phone text-blue-500 mr-2"></i>Phone Number *
                                        </label>
                                    </div>
                                    <div class="text-sm text-gray-500 mt-2 flex items-center">
                                        <i class="fas fa-star text-red-400 mr-1"></i>
                                        <span>10-Digit Mobile Number Required</span>
                                    </div>
                                </div>
                                
                                <!-- Address Type -->
                                <div>
                                    <div class="floating-label">
                                        <select id="addressType" required
                                                class="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition input-highlight appearance-none bg-white">
                                            <option value="" disabled selected></option>
                                            <option value="Flat">üè¢ Flat</option>
                                            <option value="Hostel">üè´ Hostel</option>
                                            <option value="House">üè† House</option>
                                            <option value="Office">üíº Office</option>
                                            <option value="PG">üõèÔ∏è P.G.</option>
                                        </select>
                                        <label for="addressType">
                                            <i class="fas fa-home text-blue-500 mr-2"></i>Address Type *
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- Flat/House Number -->
                                <div>
                                    <div class="floating-label">
                                        <input type="text" id="houseNumber" required 
                                               class="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition input-highlight"
                                               placeholder=" ">
                                        <label for="houseNumber">
                                            <i class="fas fa-building text-blue-500 mr-2"></i>Flat/House/Office No. *
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- Floor Number -->
                                <div>
                                    <div class="floating-label">
                                        <input type="text" id="floorNumber" 
                                               class="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition input-highlight"
                                               placeholder=" ">
                                        <label for="floorNumber">
                                            <i class="fas fa-stairs text-blue-500 mr-2"></i>Floor No.
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- Locality -->
                                <div class="md:col-span-2">
                                    <div class="floating-label">
                                        <input type="text" id="locality" required 
                                               class="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition input-highlight"
                                               placeholder=" ">
                                        <label for="locality">
                                            <i class="fas fa-location-dot text-blue-500 mr-2"></i>Locality *
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- Street Name -->
                                <div class="md:col-span-2">
                                    <div class="floating-label">
                                        <input type="text" id="street" required 
                                               class="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition input-highlight"
                                               placeholder=" ">
                                        <label for="street">
                                            <i class="fas fa-road text-blue-500 mr-2"></i>Street Name *
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- Pincode -->
                                <div>
                                    <div class="floating-label">
                                        <input type="text" id="pincode" required maxlength="6"
                                               class="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition input-highlight"
                                               placeholder=" "
                                               pattern="[0-9]{6}">
                                        <label for="pincode">
                                            <i class="fas fa-map-pin text-blue-500 mr-2"></i>Pin-Code *
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- City (auto-filled) -->
                                <div>
                                    <div class="floating-label">
                                        <input type="text" id="city" readonly
                                               class="w-full p-4 border-2 border-gray-300 rounded-lg bg-gray-50/80"
                                               placeholder=" ">
                                        <label for="city">
                                            <i class="fas fa-city text-blue-500 mr-2"></i>City
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- State (auto-filled) -->
                                <div class="md:col-span-2">
                                    <div class="floating-label">
                                        <input type="text" id="state" readonly
                                               class="w-full p-4 border-2 border-gray-300 rounded-lg bg-gray-50/80"
                                               placeholder=" ">
                                        <label for="state">
                                            <i class="fas fa-flag text-blue-500 mr-2"></i>State
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- Special Request Note -->
                                <div class="md:col-span-2">
                                    <div class="floating-label">
                                        <textarea id="specialRequest" 
                                                  class="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition input-highlight resize-none"
                                                  rows="3"
                                                  placeholder=" "></textarea>
                                        <label for="specialRequest">
                                            <i class="fas fa-sticky-note text-blue-500 mr-2"></i>Special Request Note
                                            <span class="text-sm text-gray-500 font-normal">(IF ANY)</span>
                                        </label>
                                    </div>
                                    <div class="mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                                        <p class="text-sm text-yellow-700 flex items-center">
                                            <i class="fas fa-exclamation-triangle mr-2 text-yellow-500"></i>
                                            Please Avoid Unnecessary Requests. Additional Charges may apply for Special Requests.
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Delivery Mode Selection -->
                            <div class="mt-8">
                                <h3 class="text-xl font-bold mb-4">Select Delivery Mode</h3>
                                <div class="grid grid-cols-2 gap-4">
                                    <div id="delivery-option" class="border-2 border-blue-200 bg-blue-50 rounded-xl p-4 cursor-pointer">
                                        <div class="flex items-center gap-3">
                                            <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center">
                                                <i class="fas fa-motorcycle text-white"></i>
                                            </div>
                                            <div>
                                                <p class="font-bold">Home Delivery</p>
                                                <p class="text-sm text-blue-600">Delivered to your address</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="takeaway-option" class="border-2 border-gray-200 rounded-xl p-4 cursor-pointer hover:border-green-500">
                                        <div class="flex items-center gap-3">
                                            <div class="w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center">
                                                <i class="fas fa-store text-gray-600"></i>
                                            </div>
                                            <div>
                                                <p class="font-bold">Takeaway</p>
                                                <p class="text-sm text-gray-600">Pickup from Prime Square</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Location Button (for delivery only) -->
                            <div id="location-section" class="mt-8">
                                <button type="button" id="getLocationBtn" 
                                        class="w-full flex items-center justify-center gap-3 p-5 bg-gradient-to-r from-blue-500 to-purple-500 text-white font-bold rounded-xl hover:from-blue-600 hover:to-purple-600 transition-all duration-300 shadow-xl hover:shadow-2xl transform hover:-translate-y-1 pulse">
                                    <i class="fas fa-map-marker-alt text-xl"></i>
                                    <span class="text-lg">üìç Verify Your Location on Map</span>
                                    <i class="fas fa-arrow-right ml-auto"></i>
                                </button>
                                <p class="text-sm text-gray-600 mt-3 text-center flex items-center justify-center">
                                    <i class="fas fa-info-circle mr-2 text-blue-500"></i>
                                    Click to Mark your Location for Accurate Delivery Charge Calculation.
                                </p>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Right Column: Map and Charges -->
                <div class="lg:w-1/2">
                    <!-- Map Container -->
                    <div id="map-section" class="bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 mb-6 slide-in border border-white/20">
                        <h2 class="text-3xl font-bold text-gray-800 mb-6 flex items-center">
                            <i class="fas fa-map-marked-alt text-blue-500 mr-3 bg-blue-100 p-3 rounded-full"></i>
                            Live Location Verification
                        </h2>
                        
                        <div id="map" class="map-container border-2 border-blue-200 shadow-inner"></div>
                        
                        <!-- Location Actions -->
                        <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <button id="useCurrentLocationBtn" 
                                    class="flex items-center justify-center gap-3 p-4 bg-gradient-to-r from-blue-100 to-blue-50 border-2 border-blue-200 text-blue-700 font-bold rounded-xl hover:bg-blue-100 hover:border-blue-300 transition-all duration-300 transform hover:scale-105 group">
                                <i class="fas fa-location-crosshairs text-xl group-hover:animate-ping"></i>
                                <span class="font-semibold">üìç Use My Current Location</span>
                            </button>
                            <button id="manualLocationBtn" 
                                    class="flex items-center justify-center gap-3 p-4 bg-gradient-to-r from-purple-100 to-purple-50 border-2 border-purple-200 text-purple-700 font-bold rounded-xl hover:bg-purple-100 hover:border-purple-300 transition-all duration-300 transform hover:scale-105 group">
                                <i class="fas fa-map-pin text-xl group-hover:bounce"></i>
                                <span class="font-semibold">üìå Drop Pin Manually</span>
                            </button>
                        </div>
                        
                        <!-- Location Status -->
                        <div id="locationStatus" class="mt-6 p-4 rounded-xl hidden">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mr-4">
                                        <i class="fas fa-check-circle text-2xl text-green-600"></i>
                                    </div>
                                    <div>
                                        <span id="locationText" class="text-green-700 font-bold text-lg">Location Set!</span>
                                        <p class="text-sm text-gray-600 mt-1">Distance from Prime Square: <span id="previewDistance" class="font-bold">-- km</span></p>
                                    </div>
                                </div>
                                <button id="copyLocationLinkBtn" class="flex items-center gap-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition">
                                    <i class="fas fa-link"></i>
                                    <span>Copy Location</span>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Location Link (Hidden until generated) -->
                        <div id="locationLinkContainer" class="mt-4 p-4 bg-blue-50 border border-blue-200 rounded-xl hidden">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <i class="fas fa-share-alt text-blue-500 text-xl"></i>
                                    <div>
                                        <p class="text-sm font-medium text-blue-800">üìç Your Delivery Location Link:</p>
                                        <a id="locationLink" href="#" target="_blank" class="text-blue-600 text-sm break-all hover:underline"></a>
                                    </div>
                                </div>
                                <button id="copyLinkBtn" class="px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Delivery Charges -->
                    <div id="deliveryChargesCard" class="bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 slide-in border border-white/20 hidden">
                        <h2 class="text-3xl font-bold text-gray-800 mb-6 flex items-center">
                            <i class="fas fa-truck-loading text-blue-500 mr-3 bg-blue-100 p-3 rounded-full"></i>
                            Delivery Charges Summary
                        </h2>
                        
                        <div class="space-y-5">
                            <!-- Distance Display -->
                            <div class="flex justify-between items-center p-5 bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200 rounded-xl">
                                <div class="flex items-center gap-3">
                                    <div class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center">
                                        <i class="fas fa-route text-white"></i>
                                    </div>
                                    <div>
                                        <p class="font-medium text-gray-700">Distance from Prime Square</p>
                                        <p class="text-sm text-gray-500">Your Order Location</p>
                                    </div>
                                </div>
                                <span id="distanceValue" class="text-3xl font-bold text-blue-700">-- km</span>
                            </div>
                            
                            <!-- Charges Breakdown -->
                            <div class="space-y-3">
                                <div class="flex justify-between items-center p-4 bg-gray-50 rounded-xl">
                                    <span class="font-medium text-gray-700">Base Fare</span>
                                    <span id="baseFare" class="font-bold text-gray-800 text-xl">‚Çπ0</span>
                                </div>
                                
                                <div class="flex justify-between items-center p-4 bg-gray-50 rounded-xl">
                                    <span class="font-medium text-gray-700">GST (18%)</span>
                                    <span id="gstValue" class="font-bold text-gray-800 text-xl">‚Çπ0</span>
                                </div>
                                
                                <div class="border-t-2 border-dashed border-gray-300 pt-5">
                                    <div class="flex justify-between items-center p-5 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl">
                                        <div class="flex items-center gap-3">
                                            <div class="w-12 h-12 bg-green-500 rounded-full flex items-center justify-center">
                                                <i class="fas fa-rupee-sign text-white"></i>
                                            </div>
                                            <div>
                                                <p class="font-bold text-gray-800 text-lg">Total Delivery Charge</p>
                                                <p class="text-sm text-green-600">Inclusive of all Taxes</p>
                                            </div>
                                        </div>
                                        <span id="totalCharge" class="font-bold text-green-700 text-4xl">‚Çπ0</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Free Delivery Offer -->
                            <div id="freeDeliveryOffer" class="p-5 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl hidden">
                                <div class="flex items-center gap-4">
                                    <div class="w-14 h-14 bg-green-500 rounded-full flex items-center justify-center">
                                        <i class="fas fa-gift text-2xl text-white"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-green-800 text-lg mb-1">üéâ FREE DELIVERY!</h4>
                                        <p class="text-green-700">
                                            Your order value exceeds ‚Çπ199, So Delivery is completely FREE!
                                            <span class="font-bold">You save: <span id="savingsAmount">‚Çπ0</span></span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Delivery Range Warning -->
                            <div id="rangeWarning" class="p-5 bg-red-50 border-2 border-red-200 rounded-xl hidden">
                                <div class="flex items-center gap-4">
                                    <div class="w-14 h-14 bg-red-500 rounded-full flex items-center justify-center">
                                        <i class="fas fa-exclamation-triangle text-2xl text-white"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-red-800 text-lg mb-1">‚ö†Ô∏è Beyond Delivery Range</h4>
                                        <p class="text-red-700">
                                            Your location is beyond our delivery range. Please select <span class="font-bold">Takeaway</span> option.
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Action Buttons -->
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-8">
                                <button id="proceedToPaymentBtn" 
                                        class="flex items-center justify-center gap-3 p-5 bg-gradient-to-r from-green-500 to-emerald-500 text-white font-bold rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 group">
                                    <i class="fas fa-check-circle text-xl group-hover:scale-110 transition-transform"></i>
                                    <span class="text-lg">‚úÖ Proceed to Payment</span>
                                </button>
                                <a href="https://clean-scripts.github.io/Easygo-Cart/" 
                                   class="flex items-center justify-center gap-3 p-5 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 group">
                                    <i class="fas fa-arrow-left text-xl"></i>
                                    <span class="text-lg">‚Üê Back to Cart</span>
                                </a>
                            </div>
                            
                            <p class="text-xs text-gray-600 text-center mt-6 flex items-center justify-center">
                                <i class="fas fa-shield-alt mr-2 text-blue-500"></i>
                                Your Data is Secure. Details will be shared with EasyGo for Order Processing.
                            </p>
                        </div>
                    </div>
                    
                    <!-- Takeaway Summary -->
                    <div id="takeawaySummary" class="bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 slide-in border border-white/20 hidden">
                        <h2 class="text-3xl font-bold text-gray-800 mb-6 flex items-center">
                            <i class="fas fa-store text-green-500 mr-3 bg-green-100 p-3 rounded-full"></i>
                            Takeaway Summary
                        </h2>
                        
                        <div class="space-y-5">
                            <div class="p-5 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl">
                                <div class="flex items-center gap-4">
                                    <div class="w-14 h-14 bg-green-500 rounded-full flex items-center justify-center">
                                        <i class="fas fa-store text-2xl text-white"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-green-800 text-lg mb-1">üõçÔ∏è Takeaway Selected</h4>
                                        <p class="text-green-700">
                                            Pickup from: <span class="font-bold">Prime Square, Omaxe City 1, Indore</span>
                                        </p>
                                        <p class="text-sm text-green-600 mt-2">
                                            Timings: 6:00 PM - 10:00 PM
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Action Buttons -->
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-8">
                                <button id="proceedToPaymentTakeawayBtn" 
                                        class="flex items-center justify-center gap-3 p-5 bg-gradient-to-r from-green-500 to-emerald-500 text-white font-bold rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 group">
                                    <i class="fas fa-check-circle text-xl group-hover:scale-110 transition-transform"></i>
                                    <span class="text-lg">‚úÖ Proceed to Payment</span>
                                </button>
                                <button id="switchToDeliveryBtn" 
                                        class="flex items-center justify-center gap-3 p-5 bg-blue-100 text-blue-700 font-bold rounded-xl hover:bg-blue-200 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 group">
                                    <i class="fas fa-motorcycle text-xl"></i>
                                    <span class="text-lg">Switch to Delivery</span>
                                </button>
                            </div>
                            
                            <p class="text-xs text-gray-600 text-center mt-6 flex items-center justify-center">
                                <i class="fas fa-clock mr-2 text-green-500"></i>
                                Your order will be prepared and ready for pickup in 20-25 minutes
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Footer -->
            <footer class="mt-12 text-center text-white/90">
                <div class="flex flex-col md:flex-row justify-between items-center gap-6">
                    <div class="flex items-center gap-6">
                        <div class="flex items-center gap-2">
                            <i class="fas fa-shield-alt"></i>
                            <p>Secure Payment Verification</p>
                        </div>
                     <div class="h-6 w-px bg-white/30"></div>
                        <div class="flex items-center gap-2">
                            <i class="fas fa-bolt"></i>
                            <p>Instant Delivery Quotes</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 pt-6 border-t border-white/20">
                    <p class="text-sm text-white/70">
                        &copy; 2024 EasyGo | Clean-Scripts | All Rights Reserved !
                    </p>
                </div>
            </footer>
        </div>
    </div>
    
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-10 rounded-2xl shadow-2xl text-center max-w-sm transform scale-110">
            <div class="loader mx-auto mb-6"></div>
            <p class="text-xl font-bold text-gray-800 mb-2">Processing Your Request</p>
            <p class="text-gray-600">Please wait while we verify your details...</p>
            <div class="mt-4 w-full bg-gray-200 rounded-full h-2">
                <div id="loadingProgress" class="bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
        </div>
    </div>
    
    <script>
        // Initialize map
        let map;
        let userMarker;
        let userLocation = null;
        let deliveryMode = 'delivery'; // 'delivery' or 'takeaway'
        let googleMapsLink = "";
        
        // Updated Correct Locations based on provided coordinates
        const primeSquareLocation = [22.7767737, 75.9605483]; // Prime Square, Omaxe City 1, Indore
        const taskusLocation = [22.7500367, 75.9021075]; // Taskus, Indore
        const brilliantSapphireLocation = [22.7633039, 75.8814454]; // Brilliant Sapphire, Indore
        const ligSquareLocation = [22.7336625, 75.8875296]; // L.I.G. Square, Indore
        
        // Pincode data (mock for demo - in production use an API)
        const pincodeData = {
            "452001": {city: "Indore", state: "Madhya Pradesh"},
            "452002": {city: "Indore", state: "Madhya Pradesh"},
            "452003": {city: "Indore", state: "Madhya Pradesh"},
            "452004": {city: "Indore", state: "Madhya Pradesh"},
            "452005": {city: "Indore", state: "Madhya Pradesh"},
            "452006": {city: "Indore", state: "Madhya Pradesh"},
            "452007": {city: "Indore", state: "Madhya Pradesh"},
            "452008": {city: "Indore", state: "Madhya Pradesh"},
            "452009": {city: "Indore", state: "Madhya Pradesh"},
            "452010": {city: "Indore", state: "Madhya Pradesh"},
            "452011": {city: "Indore", state: "Madhya Pradesh"},
            "452012": {city: "Indore", state: "Madhya Pradesh"},
            "452013": {city: "Indore", state: "Madhya Pradesh"},
            "452014": {city: "Indore", state: "Madhya Pradesh"},
            "452015": {city: "Indore", state: "Madhya Pradesh"},
            "452016": {city: "Indore", state: "Madhya Pradesh"},
            "452017": {city: "Indore", state: "Madhya Pradesh"},
            "452018": {city: "Indore", state: "Madhya Pradesh"}
        };
        
        function updateProgressBar(step) {
            const progressBar = document.getElementById('progressBar');
            if (step === 1) {
                progressBar.style.width = '33%';
            } else if (step === 2) {
                progressBar.style.width = '66%';
            } else if (step === 3) {
                progressBar.style.width = '100%';
            }
        }
        
        function showLoading(show) {
            const loadingOverlay = document.getElementById('loadingOverlay');
            if (show) {
                loadingOverlay.classList.remove('hidden');
                // Animate progress bar
                let progress = 0;
                const interval = setInterval(() => {
                    progress += 5;
                    if (progress > 90) {
                        clearInterval(interval);
                    }
                    document.getElementById('loadingProgress').style.width = progress + '%';
                }, 200);
            } else {
                loadingOverlay.classList.add('hidden');
                document.getElementById('loadingProgress').style.width = '0%';
            }
        }
        
        // Initialize map
        function initMap(lat = primeSquareLocation[0], lng = primeSquareLocation[1]) {
            if (!map) {
                map = L.map('map').setView([lat, lng], 14);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                }).addTo(map);
                
                // Custom icons for markers
                const primeIcon = L.divIcon({
                    className: 'custom-div-icon',
                    html: '<div style="background-color: #3b82f6; width: 35px; height: 35px; border-radius: 50%; border: 3px solid white; box-shadow: 0 3px 10px rgba(0,0,0,0.4); display: flex; align-items: center; justify-content: center;"><i class="fas fa-star" style="color: white; font-size: 14px;"></i></div>',
                    iconSize: [35, 35],
                    iconAnchor: [17, 17]
                });
                
                // Add reference marker
                L.marker(primeSquareLocation, {icon: primeIcon}).addTo(map)
                    .bindPopup('<b>Prime Square, Omaxe City 1</b><br>üìç EasyGo Restaurant<br>üéÅ FREE Delivery if order > ‚Çπ199')
                    .openPopup();
                    
                // Add a circle for 4km radius from Prime Square
                L.circle(primeSquareLocation, {
                    color: '#3b82f6',
                    fillColor: '#3b82f6',
                    fillOpacity: 0.15,
                    radius: 4000 // 4km in meters
                }).addTo(map).bindPopup('4km FREE Delivery zone from Prime Square');
                
                // Add a circle for 10km delivery range
                L.circle(primeSquareLocation, {
                    color: '#f59e0b',
                    fillColor: '#f59e0b',
                    fillOpacity: 0.1,
                    radius: 10000 // 10km in meters
                }).addTo(map).bindPopup('Maximum Delivery Range (10km)');
            } else {
                map.setView([lat, lng], 14);
            }
        }
        
        // Calculate distance between two coordinates in km
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // Earth's radius in km
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
                Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c; // Distance in km
        }
        
        // Calculate Delivery charges based on distance AND order amount
        function calculateDeliveryCharges(distance) {
            let baseCharge = 0;
            let offerText = "";
            let showOffer = false;
            let freeDelivery = false;
            let beyondRange = false;
            
            // Check cart total
            const cartTotal = parseFloat(localStorage.getItem('easygo-cart-total')) || 0;
            const freeDeliveryEligible = cartTotal > 199;
            
            // Check if beyond delivery range (10km)
            if (distance > 10) {
                beyondRange = true;
                return {
                    beyondRange: true,
                    distance: distance.toFixed(2),
                    message: "Beyond 10km delivery range. Please select Takeaway."
                };
            }
            
            // ‚úÖ ANSWER TO YOUR QUESTION: If within 4km AND order > ‚Çπ199 = FREE, else charged
            if (distance <= 4) {
                if (freeDeliveryEligible) {
                    baseCharge = 0;
                    offerText = "üéâ FREE DELIVERY! Your order value (‚Çπ" + cartTotal + ") exceeds ‚Çπ199";
                    showOffer = true;
                    freeDelivery = true;
                } else {
                    // Within 4km but order ‚â§ ‚Çπ199: ‚Çπ2 per km as per Parameter 1
                    baseCharge = Math.ceil(distance * 2);
                    offerText = "Within 4km of Prime Square: ‚Çπ2 per km applies (order ‚â§ ‚Çπ199)";
                    showOffer = true;
                }
            } 
            // Between 4km and 10km
            else if (distance <= 10) {
                // ‚Çπ3 per km beyond 4km
                const extraKm = distance - 4;
                baseCharge = Math.ceil(4 * 2 + extraKm * 3);
                offerText = "Beyond 4km: ‚Çπ3 per km applies";
                showOffer = true;
            }
            
            // Apply GST
            const gst = baseCharge * 0.18;
            const totalCharge = baseCharge + gst;
            
            return {
                distance: distance.toFixed(2),
                baseCharge: baseCharge,
                gst: gst.toFixed(2),
                totalCharge: totalCharge.toFixed(2),
                offerText: offerText,
                showOffer: showOffer,
                freeDelivery: freeDelivery,
                savings: freeDelivery ? totalCharge : 0,
                beyondRange: false
            };
        }
        
        // Generate Google Maps link from coordinates
        function generateGoogleMapsLink(lat, lng) {
            return `https://www.google.com/maps?q=${lat},${lng}&z=17`;
        }
        
        // Update Delivery charges display
        function updateDeliveryCharges() {
            if (!userLocation) return;
            
            // Calculate distance from Prime Square
            const distance = calculateDistance(
                primeSquareLocation[0], primeSquareLocation[1],
                userLocation.lat, userLocation.lng
            );
            
            // Calculate charges
            const charges = calculateDeliveryCharges(distance);
            
            if (charges.beyondRange) {
                // Show range warning
                document.getElementById('rangeWarning').classList.remove('hidden');
                document.getElementById('freeDeliveryOffer').classList.add('hidden');
                document.getElementById('proceedToPaymentBtn').disabled = true;
                document.getElementById('proceedToPaymentBtn').classList.add('opacity-50', 'cursor-not-allowed');
                return;
            }
            
            // Hide range warning
            document.getElementById('rangeWarning').classList.add('hidden');
            document.getElementById('proceedToPaymentBtn').disabled = false;
            document.getElementById('proceedToPaymentBtn').classList.remove('opacity-50', 'cursor-not-allowed');
            
            // Update UI
            document.getElementById('distanceValue').textContent = `${charges.distance} km`;
            document.getElementById('previewDistance').textContent = `${charges.distance} km`;
            document.getElementById('baseFare').textContent = `‚Çπ${charges.baseCharge}`;
            document.getElementById('gstValue').textContent = `‚Çπ${charges.gst}`;
            document.getElementById('totalCharge').textContent = `‚Çπ${charges.totalCharge}`;
            document.getElementById('savingsAmount').textContent = `‚Çπ${charges.savings}`;
            
            // Show/hide free Delivery offer
            const freeDeliveryOffer = document.getElementById('freeDeliveryOffer');
            
            if (charges.freeDelivery) {
                freeDeliveryOffer.classList.remove('hidden');
            } else {
                freeDeliveryOffer.classList.add('hidden');
            }
            
            // Generate location link
            googleMapsLink = generateGoogleMapsLink(userLocation.lat, userLocation.lng);
            document.getElementById('locationLink').textContent = googleMapsLink;
            document.getElementById('locationLink').href = googleMapsLink;
            document.getElementById('locationLinkContainer').classList.remove('hidden');
            
            // Show Delivery charges card
            document.getElementById('deliveryChargesCard').classList.remove('hidden');
            
            // Update progress
            updateProgressBar(3);
            
            // Save delivery data
            const deliveryData = {
                mode: 'delivery',
                distance: charges.distance,
                charge: charges.totalCharge,
                location: userLocation,
                locationLink: googleMapsLink
            };
            localStorage.setItem('easygo-delivery', JSON.stringify(deliveryData));
        }
        
        // Set user location on map
        function setUserLocation(lat, lng) {
            userLocation = { lat, lng };
            
            // Remove existing marker
            if (userMarker) {
                map.removeLayer(userMarker);
            }
            
            // Custom user marker
            const userIcon = L.divIcon({
                className: 'custom-div-icon',
                html: '<div style="background: linear-gradient(135deg, #8b5cf6, #3b82f6); width: 45px; height: 45px; border-radius: 50%; border: 4px solid white; box-shadow: 0 5px 15px rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center;"><i class="fas fa-home" style="color: white; font-size: 18px;"></i></div>',
                iconSize: [45, 45],
                iconAnchor: [22, 22]
            });
            
            // Add new marker
            userMarker = L.marker([lat, lng], {
                icon: userIcon,
                draggable: true
            }).addTo(map);
            
            // Update location if marker is dragged
            userMarker.on('dragend', function(event) {
                const marker = event.target;
                const position = marker.getLatLng();
                userLocation = { lat: position.lat, lng: position.lng };
                updateDeliveryCharges();
                
                // Update location status
                const locationText = document.getElementById('locationText');
                locationText.textContent = `üìç Location Updated!`;
            });
            
            // Center map on user location
            map.setView([lat, lng], 16);
            
            // Show location status
            const locationStatus = document.getElementById('locationStatus');
            const locationText = document.getElementById('locationText');
            locationText.textContent = `üìç Location Set!`;
            locationStatus.classList.remove('hidden');
            
            // Update Delivery charges
            updateDeliveryCharges();
            
            // Hide loading
            showLoading(false);
        }
        
        // Get current location
        function getCurrentLocation() {
            // Check if form is filled
            if (!validateForm()) {
                return;
            }
            
            showLoading(true);
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        setUserLocation(lat, lng);
                    },
                    (error) => {
                        console.error("Error getting location:", error);
                        showLoading(false);
                        alert("üìç Unable to get your location. Please allow location access or use manual pin drop.");
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 15000,
                        maximumAge: 0
                    }
                );
            } else {
                showLoading(false);
                alert("üìç Geolocation is not supported by this browser.");
            }
        }
        
        // Validate form fields
        function validateForm() {
            const requiredFields = ['name', 'phone', 'addressType', 'houseNumber', 'locality', 'street', 'pincode'];
            let isValid = true;
            
            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                    field.classList.add('shake', 'border-red-500');
                    setTimeout(() => field.classList.remove('shake'), 500);
                    isValid = false;
                    
                    // Scroll to first error
                    if (isValid === false) {
                        field.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                } else {
                    field.classList.remove('border-red-500');
                }
            });
            
            if (!isValid) {
                alert('‚ùå Please fill in all required fields (marked with *) before verifying location.');
                return false;
            }
            
            // Validate phone number
            const phone = document.getElementById('phone').value;
            if (!/^\d{10}$/.test(phone)) {
                document.getElementById('phone').classList.add('shake', 'border-red-500');
                setTimeout(() => document.getElementById('phone').classList.remove('shake'), 500);
                alert('‚ùå Please enter a valid 10-digit phone number.');
                return false;
            }
            
            // Validate pincode
            const pincode = document.getElementById('pincode').value;
            if (!/^\d{6}$/.test(pincode)) {
                document.getElementById('pincode').classList.add('shake', 'border-red-500');
                setTimeout(() => document.getElementById('pincode').classList.remove('shake'), 500);
                alert('‚ùå Please enter a valid 6-digit pincode.');
                return false;
            }
            
            // Save address to localStorage
            const address = {
                name: document.getElementById('name').value,
                phone: document.getElementById('phone').value,
                addressType: document.getElementById('addressType').value,
                houseNumber: document.getElementById('houseNumber').value,
                floorNumber: document.getElementById('floorNumber').value,
                locality: document.getElementById('locality').value,
                street: document.getElementById('street').value,
                pincode: document.getElementById('pincode').value,
                city: document.getElementById('city').value,
                state: document.getElementById('state').value,
                specialRequest: document.getElementById('specialRequest').value
            };
            localStorage.setItem('easygo-address', JSON.stringify(address));
            
            return true;
        }
        
        // Switch to delivery mode
        function switchToDelivery() {
            deliveryMode = 'delivery';
            document.getElementById('delivery-option').classList.add('border-blue-500', 'bg-blue-50');
            document.getElementById('delivery-option').classList.remove('border-gray-200');
            document.getElementById('takeaway-option').classList.add('border-gray-200');
            document.getElementById('takeaway-option').classList.remove('border-green-500', 'bg-green-50');
            
            document.getElementById('map-section').classList.remove('hidden');
            document.getElementById('location-section').classList.remove('hidden');
            document.getElementById('takeawaySummary').classList.add('hidden');
            
            // Initialize map if not already
            if (!map) {
                initMap();
            }
        }
        
        // Switch to takeaway mode
        function switchToTakeaway() {
            deliveryMode = 'takeaway';
            document.getElementById('takeaway-option').classList.add('border-green-500', 'bg-green-50');
            document.getElementById('takeaway-option').classList.remove('border-gray-200');
            document.getElementById('delivery-option').classList.add('border-gray-200');
            document.getElementById('delivery-option').classList.remove('border-blue-500', 'bg-blue-50');
            
            document.getElementById('map-section').classList.add('hidden');
            document.getElementById('location-section').classList.add('hidden');
            document.getElementById('deliveryChargesCard').classList.add('hidden');
            document.getElementById('takeawaySummary').classList.remove('hidden');
            
            // Save takeaway data
            const takeawayData = {
                mode: 'takeaway',
                pickupLocation: 'Prime Square, Omaxe City 1, Indore',
                timings: '6:00 PM - 10:00 PM'
            };
            localStorage.setItem('easygo-delivery', JSON.stringify(takeawayData));
        }
        
        // Load cart summary
        function loadCartSummary() {
            const cart = JSON.parse(localStorage.getItem('easygo-cart')) || [];
            const cartTotal = localStorage.getItem('easygo-cart-total') || '0';
            
            if (cart.length > 0) {
                document.getElementById('cart-summary-badge').classList.remove('hidden');
                document.getElementById('cart-items-count').textContent = `${cart.length} items`;
                document.getElementById('cart-total-badge').textContent = `‚Çπ${cartTotal}`;
            }
        }
        
        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize map
            initMap();
            
            // Load cart summary
            loadCartSummary();
            
            // Update progress
            updateProgressBar(2);
            
            // Pincode lookup
            document.getElementById('pincode').addEventListener('input', function() {
                const pincode = this.value;
                if (pincode.length === 6 && pincodeData[pincode]) {
                    document.getElementById('city').value = pincodeData[pincode].city;
                    document.getElementById('state').value = pincodeData[pincode].state;
                } else if (pincode.length === 6) {
                    // For demo purposes, set to Indore if pincode not in data
                    document.getElementById('city').value = "Indore";
                    document.getElementById('state').value = "Madhya Pradesh";
                }
            });
            
            // Delivery mode selection
            document.getElementById('delivery-option').addEventListener('click', switchToDelivery);
            document.getElementById('takeaway-option').addEventListener('click', switchToTakeaway);
            
            // Get location button
            document.getElementById('getLocationBtn').addEventListener('click', function() {
                getCurrentLocation();
            });
            
            // Use current location button
            document.getElementById('useCurrentLocationBtn').addEventListener('click', getCurrentLocation);
            
            // Manual location button
            document.getElementById('manualLocationBtn').addEventListener('click', function() {
                // Check if form is filled
                if (!validateForm()) {
                    return;
                }
                
                alert('üó∫Ô∏è Click on the map to drop a pin at your location. You can drag the pin to adjust.');
                
                // Set up map click listener
                map.once('click', function(e) {
                    setUserLocation(e.latlng.lat, e.latlng.lng);
                });
            });
            
            // Copy location link
            document.getElementById('copyLocationLinkBtn').addEventListener('click', function() {
                document.getElementById('locationLinkContainer').classList.remove('hidden');
                document.getElementById('copyLinkBtn').click();
            });
            
            document.getElementById('copyLinkBtn').addEventListener('click', function() {
                navigator.clipboard.writeText(googleMapsLink).then(() => {
                    const btn = document.getElementById('copyLinkBtn');
                    const originalHTML = btn.innerHTML;
                    btn.innerHTML = '<i class="fas fa-check"></i>';
                    btn.classList.remove('bg-blue-500');
                    btn.classList.add('bg-green-500');
                    setTimeout(() => {
                        btn.innerHTML = originalHTML;
                        btn.classList.remove('bg-green-500');
                        btn.classList.add('bg-blue-500');
                    }, 2000);
                });
            });
            
            // Proceed to payment (delivery)
            document.getElementById('proceedToPaymentBtn').addEventListener('click', function() {
                if (!validateForm()) {
                    return;
                }
                
                if (deliveryMode === 'delivery' && !userLocation) {
                    alert('üìç Please set your location first');
                    return;
                }
                
                window.location.href = 'https://clean-scripts.github.io/Easygo-Payment/';
            });
            
            // Proceed to payment (takeaway)
            document.getElementById('proceedToPaymentTakeawayBtn').addEventListener('click', function() {
                if (!validateForm()) {
                    return;
                }
                
                window.location.href = 'https://clean-scripts.github.io/Easygo-Payment/';
            });
            
            // Switch to delivery
            document.getElementById('switchToDeliveryBtn').addEventListener('click', switchToDelivery);
            
            // Form validation styling
            const formInputs = document.querySelectorAll('#addressForm input, #addressForm select, #addressForm textarea');
            formInputs.forEach(input => {
                input.addEventListener('blur', function() {
                    if (this.value.trim() === '' && this.hasAttribute('required')) {
                        this.classList.add('border-red-500');
                    } else {
                        this.classList.remove('border-red-500');
                    }
                });
                
                input.addEventListener('input', function() {
                    if (this.value.trim() !== '') {
                        this.classList.remove('border-red-500');
                    }
                });
            });
            
            // Default to delivery mode
            switchToDelivery();
        });
    </script>
</body>
</html>
